.\" Man page generated from reStructuredText.
.
.TH "TXT2XLS" "1" "February 19, 2014" "0.2.1" "txt2xls"
.SH NAME
txt2xls \- Convert raw text files into a single excel file.
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.sp
\fBtxt2xls\fP [\fIoptions\fP] \-o <\fIoutput filename\fP> [\fIpathnames\fP ...]
.SH DESCRIPTION
.sp
\fBtxt2xls\fP is a tool for automatic convertion for raw text files
into a single Microsoft Excel file.
.sp
It use \fI\%maidenhair\fP parser and loader plugins for loading raw text files.
It means that \fBtxt2xls\fP can load any formats of raw text files when
there are plugins suite for the format.
.SH OPTIONS
.INDENT 0.0
.TP
.B \fB\-h, \-\-help\fP
show this help message and exit
.TP
.B \fB\-v, \-\-version\fP
show program\(aqs version number and exit
.TP
.B \fB\-\-raise\-exception\fP
If it is specified, raise exceptions.
.TP
.B \fB\-o OUTFILE, \-\-outfile OUTFILE\fP
An output filename without extensions. The required
filename extension will be automatically determined
from an output format.
.UNINDENT
.SS Reading options
.INDENT 0.0
.TP
.B \fB\-p PARSER, \-\-parser PARSER\fP
A maidenhair parser name which will be used to parse
the raw text data.
.TP
.B \fB\-l LOADER, \-\-loader LOADER\fP
A maidenhair loader name which will be used to load
the raw text data.
.TP
.B \fB\-u USING, \-\-using USING\fP
A colon (:) separated column indexes. It is used for
limiting the reading columns.
.UNINDENT
.SS Unite options
.INDENT 0.0
.TP
.B \fB\-\-unite\fP
Join the columns of classified dataset with respecting
\fI\-\-unite\-basecolumn\fP\&. The dataset is classified with
\fI\-\-unite\-function\fP\&.
.TP
.B \fB\-\-unite\-basecolumn UNITE_BASECOLUMN\fP
An index of columns which will be used as a base
column for regulating data point region.
.TP
.B \fB\-\-unite\-function UNITE_FUNCTION\fP
A python script file path or a content of python
lambda expression which will be used for classifing
dataset. If it is not spcified, a filename character
before period (.) will be used to classify.
See \fBFunction expression\fP section below.
.UNINDENT
.SS Classify options
.INDENT 0.0
.TP
.B \fB\-\-classify\fP
Classify dataset with \-\-classify\-function. It will
influence the results of \-\-relative and \-\-baseline.
.TP
.B \fB\-\-classify\-function CLASSIFY_FUNCTION\fP
A python script file path or a content of python
lambda expression which will be used for classifing
dataset. If it is not specified, a filename character
before the last underscore (_) will be used to
classify.
See \fBFunction expression\fP section below.
.UNINDENT
.SS Relative options
.INDENT 0.0
.TP
.B \fB\-\-relative\fP
If it is True, the raw data will be converted to
relative data from the specified origin, based on the
specified column. See \fI\-\-relative\-origin\fP and
\fI\-\-relative\-basecolumn\fP also.
.TP
.B \fB\-\-relative\-origin RELATIVE_ORIGIN\fP
A dataset number which will be used as an orign of the
relative data. It is used with \fI\-\-relative\fP option.
.TP
.B \fB\-\-relative\-basecolumn RELATIVE_BASECOLUMN\fP
A column number which will be used as a base column to
make the data relative. It is used with \fI\-\-relative\fP
option.
.UNINDENT
.SS Baseline options
.INDENT 0.0
.TP
.B \fB\-\-baseline\fP
If it is specified, the specified data file is used as
a baseline of the dataset. See \fI\-\-baseline\-basecolumn\fP
and \fI\-\-baseline\-function\fP also.
.TP
.B \fB\-\-baseline\-basecolumn BASELINE_BASECOLUMN\fP
A column index which will be proceeded for baseline
regulation. It is used with \fI\-\-baseline\fP option.
.TP
.B \fB\-\-baseline\-function BASELINE_FUNCTION\fP
A python script file path or a content of python
lambda expression which will be used to determine the
baseline value from the data. \fIcolumns\fP and \fIcolumn\fP
variables are available in the lambda expression.
See \fBFunction expression\fP section below.
.UNINDENT
.SS Peakset options
.INDENT 0.0
.TP
.B \fB\-\-peakset\-method {argmin, argmax}\fP
A method to find peak data point.
.TP
.B \fB\-\-peakset\-basecolumn PEAKSET_BASECOLUMN\fP
A column index which will be used for finding peak
data point.
.TP
.B \fB\-\-peakset\-where\-function PEAKSET_WHERE_FUNCTION\fP
A python script file path or a content of python
lambda expression which will be used to limit the
range of data points for finding. peak data point.
\fIdata\fP is available in the lambda expression.
See \fBFunction expression\fP section below.
.UNINDENT
.SH FUNCTION EXPRESSION
.sp
There are four types of function expressions and there are identified by
leading function type indicator; characters before the first colon (:).
.SS lambda function
.sp
A function expression starts from \fBlambda:\fP indicate the lambda function
expression and the body (string after the \fBlambda:\fP) indicate the body of
the lambda function.
The lambda function will recieve \fB*args\fP and \fB**kwargs\fP arguments when it
is called so you can write a lambda function which return the first argument
as:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
lambda:args[0]
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The function expression above will be converted to:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
lambda *args, **kwargs: args[0]
.ft P
.fi
.UNINDENT
.UNINDENT
.SS regex function
.sp
A function expression starts from \fBregex:\fP indicate the regex function
expression and the body indicate the regular expression pattern string.
The regex function will recieve \fBdata\fP which first item indicate the
filename of the data (a row text filename) and the function check the filename
with the specified regular expression pattern.
This function is mainly used for classification function such as
\fB\-\-unite\-function\fP or \fB\-\-classify\-function\fP\&.
.sp
If the regular expression pattern has group patterns, it will return the first
group as a classification string.
It it does not have group patterns, it will return the entire match string.
If nothing can be mathced in the specified filename, entire filename will be
returned as a classification string.
.SS file function
.sp
A function expression starts from \fBfile:\fP indicate the file function
expression and the body indicate the path of the python script.
The python script will be loaded and it\(aqs \fB__call__(data)\fP function will be
used as a function.
It the python script does not have the function, it raise \fBImportError\fP\&.
.SS builtin function
.sp
A function expression starts from \fBbuiltin:\fP is a shortcut alias of file
function which points to builtin python script files.
Currently four builtin scripts are available (\fBbaseline_function\fP,
\fBclassify_function\fP, \fBunite_function\fP, and \fBwhere_function\fP).
.SH PREFERENCE
.sp
You can create configure file as \fB~/.config/txt2xls/txt2xls.cfg\fP (Linux),
\fB~/.txt2xls.cfg\fP (Mac), or \fB%APPDATA%\etxt2xls\etxt2xls.cfg\fP (Windows).
.sp
The default preference is equal to the configure file as below:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
[default]
raise_exception = False

[reader]
parser = \(aqparsers.PlainParser\(aq
loader = \(aqloaders.PlainLoader\(aq
using = None

    [[classify]]
    enabled = False
    function = \(aqbuiltin:classify_function\(aq

    [[unite]]
    enabled = False
    function = \(aqbuiltin:unite_function\(aq
    basecolumn = 0

    [[relative]]
    enabled = False
    origin = 0
    basecolumn = 1

    [[baseline]]
    enabled = False
    function = \(aqbuiltin:baseline_function\(aq
    basecolumn = 1

[writer]
default_filename = \(aqoutput.xls\(aq

    [[peakset]]
    method = \(aqargmax\(aq
    basecolumn = \-1
    where_function = \(aqbuiltin:where_function\(aq
.ft P
.fi
.UNINDENT
.UNINDENT
.SH AUTHOR
Alisue
.SH COPYRIGHT
2014, hashnote.net, Alisue
.\" Generated by docutils manpage writer.
.
